import{d as o}from"./chunk-3ADLPJCZ.js";var d=class c{constructor(){}static encrypt(a,n){return o(this,null,function*(){let e=yield c.getAesKey(n),t=crypto.getRandomValues(new Uint8Array(16)),y=new TextEncoder().encode(a),s=yield crypto.subtle.encrypt({name:"AES-CBC",iv:t},e,y);return{encrypted:c.arrayBufferToBase64(s),iv:c.arrayBufferToBase64(t)}})}static decrypt(a,n,e){return o(this,null,function*(){let t=yield c.getAesKey(e),r=c.base64ToArrayBuffer(n),y=c.base64ToArrayBuffer(a),s=yield crypto.subtle.decrypt({name:"AES-CBC",iv:r},t,y);return new TextDecoder().decode(s)})}static getAesKey(a){return o(this,null,function*(){let e=new TextEncoder().encode(a),t=yield crypto.subtle.digest("SHA-256",e);return crypto.subtle.importKey("raw",t,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"])})}static arrayBufferToBase64(a){let n="",e=new Uint8Array(a),t=e.byteLength;for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return window.btoa(n)}static base64ToArrayBuffer(a){let n=window.atob(a),e=n.length,t=new Uint8Array(e);for(let r=0;r<e;r++)t[r]=n.charCodeAt(r);return t.buffer}};export{d as a};
